<venda_block pageref=spring_cat_test>
<script type="text/javascript" src="<venda_entmediaadd>/ebiz/<venda_bsref>/resources/js/external/jquery.lazyload.min.js"></script>
<script type="text/javascript" src="http://demos.flesler.com/jquery/scrollTo/js/jquery.scrollTo-min.js"></script>
<script type="text/javascript">
jQuery(function() {          
    jQuery("img.lazy").lazyload({
        event : "lookbook"
    });
});
jQuery(window).bind("load", function() { 
	var sticky = jQuery(".gameSticky"),
		windowOffset = (document.body.clientWidth - 950) / 2,
		stickyOffsetTop = jQuery(".gameContents").offset(),
		stickyOffsetLeft = windowOffset + 950;
	sticky.css({'position':'fixed','left':stickyOffsetLeft,'top':stickyOffsetTop.top});
	
    var timeout = setTimeout(function() { 
    	jQuery("img.lazy").trigger("lookbook");
    	jQuery(window).scroll(function() {
    		var gameStage = jQuery(".gameStage").text(),
    			offset = jQuery(".gameContents").offset(),
    			offsetBottom = jQuery(document).height() - (offset.top + jQuery(".gameContents").height()),
    			scrollAmount = jQuery(window).scrollTop() - offset.top,
    			documentHeight = (jQuery(document).height() - offsetBottom - offset.top) - jQuery(window).height(),
    			scrollPercent = ((scrollAmount / documentHeight) * 100) / 3;
    		if (gameStage === "1") {
	    		if (scrollPercent.toFixed(0) <= 0) {
	    			jQuery(".percentage").text("0%");
	    		}
	    		else if (scrollPercent.toFixed(0) > 33) {
	    			jQuery(".percentage").text("33%");
	    		}
	    		else {
	    			jQuery(".percentage").text(scrollPercent.toFixed(0) + "%");
	    		}
    		}
    		if (gameStage === "2") {
    			scrollPercent = scrollPercent + 33;
	    		if (scrollPercent.toFixed(0) <= 33) {
	    			jQuery(".percentage").text("33%");
	    		}
	    		else if (scrollPercent.toFixed(0) > 66) {
	    			jQuery(".percentage").text("66%");
	    		}
	    		else {
	    			jQuery(".percentage").text(scrollPercent.toFixed(0) + "%");
	    		}
    		}
    		if (gameStage === "3") {
    			scrollPercent = scrollPercent + 66;
	    		if (scrollPercent.toFixed(0) <= 66) {
	    			jQuery(".percentage").text("66%");
	    		}
	    		else if (scrollPercent.toFixed(0) > 99) {
	    			jQuery(".percentage").text("100%");
	    		}
	    		else {
	    			jQuery(".percentage").text(scrollPercent.toFixed(0) + "%");
	    		}
    		}
    	});
    }, 0);
});
function scrollToAnchor(aid) {
    if (aid !== undefined) {
        jQuery(window).scrollTo(aid, 800, {
            margin: true
        });
    }
}
function scrollPreAnchor(adi) {
    if (adi !== undefined) {
        jQuery(window).scrollTo(adi, 800, {
            margin: true,
            offset: {top:+5}
        });
    }
}
jQuery(function() {
    var segments = jQuery('.segment'),
    	position = 0,
    	next = jQuery('.anchorLink-next'),
    	prev = jQuery('.anchorLink-prev').hide();
    next.click(function(evt) {
        scrollToAnchor(segments[position]);
    });
    prev.click(function(evt) {
	    scrollPreAnchor(segments[position - 2]);
    });
    jQuery(".toTop").click(function(evt) {
		scrollPreAnchor(segments[0]);
	});
    var lastScrollTop = 0;
    jQuery(window).scroll(function(event){
	    var st = jQuery(this).scrollTop(),
	    	scrollOffset = jQuery(".gameContents").offset(),
    		scrolled = jQuery(window).scrollTop() - scrollOffset.top,
    		segmentOffset = jQuery(segments[position]).offset(),
    		segmentTop = segmentOffset.top - scrollOffset.top,
    		segmentHeight = jQuery(".gameContents").height() / 4;
	    if (st > lastScrollTop){
		    if (scrolled >= segmentTop) {
			    segments[position += 1];
			}
       	}
       	else {
       		if (position !== 0) {
	       		if (scrolled <= (segmentTop - segmentHeight)) {
			    	segments[position -= 1];
			    }
       		}
	    }
	    if (position <= 1) {
		    prev.hide();
	    }
	    if (position > 1) {
		    prev.show();
	    }
	    lastScrollTop = st;
	});
});
var win = null;
function NewWindow(mypage,myname,w,h,scroll){
	LeftPosition = (screen.width) ? (screen.width-w)/2 : 0;
	TopPosition = (screen.height) ? (screen.height-h)/2 : 0;
	settings = 'height='+h+',width='+w+',top='+TopPosition+',left='+LeftPosition+',scrollbars='+scroll+',resizable'
	win = window.open(mypage,myname,settings)
}
</script>
</venda_block>